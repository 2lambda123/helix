




<html>
	<head>
		<title>ix.command - Helix Documentation</title>

		<meta property="og:type" content="website" />
		<meta property="og:title" content="ix.command - Helix Documentation" />
		<meta property="og:site_name" content="Helix Documentation" />

			<meta property="og:description" content="Registration, parsing, and handling of commands." />

		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Code+Pro" />
		<link rel="stylesheet" href="../ldoc.css" />
		<link rel="stylesheet" href="../highlight.css" />
	</head>

	<body>
		<aside>
			<h1>Helix</h1>

			<!-- project contents -->
			<section>
						<h2>Libraries</h2>

						<ul>
								<li><a href="../libraries/ix.html">ix</a></li>
								<li><a href="../libraries/ix.act.html">ix.act</a></li>
								<li><a href="../libraries/ix.anim.html">ix.anim</a></li>
								<li><a href="../libraries/ix.char.html">ix.char</a></li>
								<li><a href="../libraries/ix.chat.html">ix.chat</a></li>
								<li><a href="../libraries/ix.class.html">ix.class</a></li>
								<li><a href="../libraries/ix.command.html">ix.command</a></li>
								<li><a href="../libraries/ix.config.html">ix.config</a></li>
								<li><a href="../libraries/ix.currency.html">ix.currency</a></li>
								<li><a href="../libraries/ix.data.html">ix.data</a></li>
								<li><a href="../libraries/ix.date.html">ix.date</a></li>
								<li><a href="../libraries/ix.faction.html">ix.faction</a></li>
								<li><a href="../libraries/ix.flag.html">ix.flag</a></li>
								<li><a href="../libraries/ix.item.html">ix.item</a></li>
								<li><a href="../libraries/ix.lang.html">ix.lang</a></li>
								<li><a href="../libraries/ix.log.html">ix.log</a></li>
								<li><a href="../libraries/ix.menu.html">ix.menu</a></li>
								<li><a href="../libraries/ix.notice.html">ix.notice</a></li>
								<li><a href="../libraries/ix.option.html">ix.option</a></li>
								<li><a href="../libraries/ix.storage.html">ix.storage</a></li>
								<li><a href="../libraries/ix.util.html">ix.util</a></li>
						</ul>
						<h2>Hooks</h2>

						<ul>
								<li><a href="../hooks/Class.html">Class</a></li>
								<li><a href="../hooks/Faction.html">Faction</a></li>
								<li><a href="../hooks/Plugin.html">Plugin</a></li>
						</ul>
						<h2>Panels</h2>

						<ul>
								<li><a href="../panels/ixTooltip.html">ixTooltip</a></li>
								<li><a href="../panels/ixTooltipRow.html">ixTooltipRow</a></li>
						</ul>
						<h2>Classes</h2>

						<ul>
								<li><a href="../classes/Entity.html">Entity</a></li>
								<li><a href="../classes/Inventory.html">Inventory</a></li>
								<li><a href="../classes/Character.html">Character</a></li>
								<li><a href="../classes/Item.html">Item</a></li>
								<li><a href="../classes/Player.html">Player</a></li>
						</ul>
						<h2>Manual</h2>

						<ul>
								<li><a href="../manual/00-getting-started.md.html">Getting Started</a></li>
								<li><a href="../manual/10-converting-from-clockwork.md.html">Clockwork to Helix Migration</a></li>
						</ul>
			</section>
		</aside>

		<!-- library functions -->
		<article>
				<header class="module">
					<h1>ix.command</h1>
					<h2>Registration, parsing, and handling of commands.</h2>
				</header>

				<!-- description -->
				<p>Commands can be ran through the chat with slash commands or they can be executed through the console. Commands can be manually
restricted to certain usergroups using a <a href="https://github.com/glua/CAMI">CAMI</a>-compliant admin mod.</p>

				<!-- summary -->
				<details open>
					<summary>Reference</summary>

					<div class="contents">
							<h2>Functions</h2>
							<ul>
									<li><span class="realm shared"></span><a href="#ix.command.Add">ix.command.Add(command, data)</a></li>
									<li><span class="realm shared"></span><a href="#ix.command.ExtractArgs">ix.command.ExtractArgs(text)</a></li>
									<li><span class="realm shared"></span><a href="#ix.command.FindAll">ix.command.FindAll(identifier[, bSorted=false[, bReorganize=false[, bRemoveDupes=false]]])</a></li>
									<li><span class="realm server"></span><a href="#ix.command.FindPlayer">ix.command.FindPlayer(client, name)</a></li>
									<li><span class="realm shared"></span><a href="#ix.command.HasAccess">ix.command.HasAccess(client, command)</a></li>
									<li><span class="realm server"></span><a href="#ix.command.Parse">ix.command.Parse(client, text[, realCommand[, arguments]])</a></li>
									<li><span class="realm server"></span><a href="#ix.command.Run">ix.command.Run(client, command, arguments)</a></li>
									<li><span class="realm client"></span><a href="#ix.command.Send">ix.command.Send(command, ...)</a></li>
							</ul>
							<h2>Tables</h2>
							<ul>
									<li><span class="realm shared"></span><a href="#CommandArgumentsStructure">CommandArgumentsStructure</a></li>
									<li><span class="realm shared"></span><a href="#CommandStructure">CommandStructure</a></li>
							</ul>
					</div>
				</details>

				<!-- methods -->
					<h1 class="title">Functions</h1>

						<section class="method">
							<header>
								<a class="anchor" id="ix.command.Add">
									<h1><span class="realm shared"></span>ix.command.Add(command, data)</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L155">View source &raquo;</a>

								<p>Creates a new command.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">command</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Name of the command (recommended in UpperCamelCase)</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">data</span>

													<span class="tag"><a class="type" href="../libraries/ix.command.html#CommandStructure">CommandStructure</a></span>


												<p> Data describing the command</p>
											</li>
									</ul>


						</section>
						<section class="method">
								<aside>
										<pre><code>PrintTable(ix.command.ExtractArgs("these are \"some arguments\""))
> 1 = these
> 2 = are
> 3 = some arguments
</code></pre>
								</aside>
							<header>
								<a class="anchor" id="ix.command.ExtractArgs">
									<h1><span class="realm shared"></span>ix.command.ExtractArgs(text)</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L335">View source &raquo;</a>

								<p>Returns a table of arguments from a given string.
 Words separated by spaces will be considered one argument. To have an argument containing multiple words, they must be
 contained within quotation marks.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">text</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> String to extract arguments from</p>
											</li>
									</ul>


								<h3>Returns</h3>
								<ul>

											<li>
													<a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.5">table</a>

												<p>Arguments extracted from string</p>
											</li>

								</ul>

						</section>
						<section class="method">
							<header>
								<a class="anchor" id="ix.command.FindAll">
									<h1><span class="realm shared"></span>ix.command.FindAll(identifier[, bSorted=false[, bReorganize=false[, bRemoveDupes=false]]])</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L383">View source &raquo;</a>

								<p>Returns an array of potential commands by unique id.
 When bSorted is true, the commands will be sorted by name. When bReorganize is true, it will move any exact match to the top
 of the array. When bRemoveDupes is true, it will remove any commands that have the same NAME.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">identifier</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Search query</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">bSorted</span>

													<span class="tag"><span class="type">boolean</span></span>

													<span class="tag default">default: false</span>

												<p> Whether or not to sort the commands by name</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">bReorganize</span>

													<span class="tag"><span class="type">boolean</span></span>

													<span class="tag default">default: false</span>

												<p> Whether or not any exact match will be moved to the top of the array</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">bRemoveDupes</span>

													<span class="tag"><span class="type">boolean</span></span>

													<span class="tag default">default: false</span>

												<p> Whether or not to remove any commands that have the same name</p>
											</li>
									</ul>


								<h3>Returns</h3>
								<ul>

											<li>
													<a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.5">table</a>

												<p>Array of command tables whose name partially or completely matches the search query</p>
											</li>

								</ul>

						</section>
						<section class="method">
							<header>
								<a class="anchor" id="ix.command.FindPlayer">
									<h1><span class="realm server"></span>ix.command.FindPlayer(client, name)</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L443">View source &raquo;</a>

								<p>Attempts to find a player by an identifier.  If unsuccessful, a notice will be displayed to the specified player. The
 search criteria is derived from <a href="../libraries/ix.util.html#ix.util.FindPlayer">ix.util.FindPlayer</a>.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">client</span>

													<span class="tag"><a class="type" href="../classes/Player.html#">Player</a></span>


												<p> Player to give a notification to if the player could not be found</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">name</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Search query</p>
											</li>
									</ul>


								<h3>Returns</h3>
								<ul>

											<li>
													<span class="type">player</span>

												<p>Player that matches the given search query</p>
											</li>

											<div class="or"><span>OR</span></div>

											<li>
													<span class="type">nil</span>

												<p>If a player could not be found</p>
											</li>

								</ul>

								<h3>See Also</h3>
								<ul>
										<li><a href="../libraries/ix.util.html#ix.util.FindPlayer">ix.util.FindPlayer</a></li>
								</ul>
						</section>
						<section class="method">
							<header>
								<a class="anchor" id="ix.command.HasAccess">
									<h1><span class="realm shared"></span>ix.command.HasAccess(client, command)</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L311">View source &raquo;</a>

								<p>Returns true if a player is allowed to run a certain command.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">client</span>

													<span class="tag"><a class="type" href="../classes/Player.html#">Player</a></span>


												<p> Player to check access for</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">command</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Name of the command to check access for</p>
											</li>
									</ul>


								<h3>Returns</h3>
								<ul>

											<li>
													<span class="type">bool</span>

												<p>Whether or not the player is allowed to run the command</p>
											</li>

								</ul>

						</section>
						<section class="method">
								<aside>
										<pre><code>ix.command.Parse(player.GetByID(1), "/roll 10")
</code></pre>
								</aside>
							<header>
								<a class="anchor" id="ix.command.Parse">
									<h1><span class="realm server"></span>ix.command.Parse(client, text[, realCommand[, arguments]])</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L535">View source &raquo;</a>

								<p>Parses a chat string and runs the command if one is found.  Specifically, it checks for commands in a string with the
 format <code>/CommandName some arguments</code></p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">client</span>

													<span class="tag"><a class="type" href="../classes/Player.html#">Player</a></span>


												<p> Player who is executing the command</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">text</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Input string to search for the command format</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">realCommand</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>

													<span class="tag default">optional</span>

												<p> Specific command to check for. If this is specified, it will not try to run any command that's
 found at the beginning - only if it matches <code>realCommand</code></p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">arguments</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.5">table</a></span>

													<span class="tag default">optional</span>

												<p> Array of arguments to pass to the command. If not specified, it will try to extract it from the
 string specified in <code>text</code> using <a href="../libraries/ix.command.html#ix.command.ExtractArgs">ix.command.ExtractArgs</a></p>
											</li>
									</ul>


								<h3>Returns</h3>
								<ul>

											<li>
													<span class="type">bool</span>

												<p>Whether or not a command has been found</p>
											</li>

								</ul>

						</section>
						<section class="method">
								<aside>
										<pre><code>ix.command.Run(player.GetByID(1), "Roll", {10})
</code></pre>
								</aside>
							<header>
								<a class="anchor" id="ix.command.Run">
									<h1><span class="realm server"></span>ix.command.Run(client, command, arguments)</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L460">View source &raquo;</a>

								<p>Forces a player to execute a command by name.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">client</span>

													<span class="tag"><a class="type" href="../classes/Player.html#">Player</a></span>


												<p> Player who is executing the command</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">command</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Full name of the command to be executed. This string gets lowered, but it's good practice to stick with
 the exact name of the command</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">arguments</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.5">table</a></span>


												<p> Array of arguments to be passed to the command</p>
											</li>
									</ul>


						</section>
						<section class="method">
								<aside>
										<pre><code>ix.command.Send("roll", 10)
</code></pre>
								</aside>
							<header>
								<a class="anchor" id="ix.command.Send">
									<h1><span class="realm client"></span>ix.command.Send(command, ...)</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L605">View source &raquo;</a>

								<p>Request the server to run a command.  This mimics similar functionality to the client typing <code>/CommandName</code> in the chatbox.</p>
							</header>


									<h3>Parameters</h3>


									<ul>

											<li>
												<span class="tag parameter">command</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>


												<p> Unique ID of the command</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">...</span>



												<p> Arguments to pass to the command</p>
											</li>
									</ul>


						</section>
					<h1 class="title">Tables</h1>

						<section class="method">
							<header>
								<a class="anchor" id="CommandArgumentsStructure">
									<h1><span class="realm shared"></span>CommandArgumentsStructure</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L75">View source &raquo;</a>

								<p>Rather than checking the validity for arguments in your command's <code>OnRun</code> function, you can have Helix do it for you to
 reduce the amount of boilerplate code that needs to be written.  This can be done by populating the <code>arguments</code> field.</p>

<p> When using the <code>arguments</code> field in your command, you are specifying specific types that you expect to receive when the
 command is ran successfully. This means that before <code>OnRun</code> is called, the arguments passed to the command from a user will
 be verified to be valid. Each argument is an <a href="../libraries/ix.html#type">ix.type</a> entry that specifies the expected type for that argument. Optional
 arguments can be specified by using a bitwise OR with the special <code>ix.type.optional</code> type. When specified as optional, the
 argument can be <code>nil</code> if the user has not entered anything for that argument - otherwise it will be valid.</p>

<p> Note that optional arguments must always be at the end of a list of arguments - or rather, they must not follow a required
 argument. The <code>syntax</code> field will be automatically populated when using strict arguments, which means you shouldn't fill out
 the <code>syntax</code> field yourself. The arguments you specify will have the same names as the arguments in your OnRun function.</p>

<p> Consider this example command:</p>
<pre><code>ix.command.Add("CharSlap", {
    description = "Slaps a character with a large trout.",
    adminOnly = true,
    arguments = {
        ix.type.character,
        bit.bor(ix.type.number, ix.type.optional)
    },
    OnRun = function(self, client, target, damage)
        -- WHAM!
    end
})
</code></pre>
<p> Here, we've specified the first argument called <code>target</code> to be of type <code>character</code>, and the second argument called <code>damage</code>
 to be of type <code>number</code>. The <code>damage</code> argument is optional, meaning that the command will still run if the user has not
 specified any value for the damage. In this case, we'll need to check if it was specified by doing a simple
 <code>if (damage) then</code>. The syntax field will be automatically populated with the value <code>&quot;&lt;target: character&gt; [damage: number]&quot;</code>.</p>
							</header>



						</section>
						<section class="method">
							<header>
								<a class="anchor" id="CommandStructure">
									<h1><span class="realm shared"></span>CommandStructure</h1>
								</a>


									<a class="reference" href="https://github.com/nebulouscloud/helix/tree/master/gamemode/core/libs/sh_command.lua#L43">View source &raquo;</a>

								<p>When registering commands with <a href="../libraries/ix.command.html#ix.command.Add">ix.command.Add</a>, you'll need to pass in a valid command structure.  This is simply a table
 with various fields defined to describe the functionality of the command.</p>
							</header>


									<h3>Fields</h3>


									<ul>

											<li>
												<span class="tag parameter">OnRun</span>

													<span class="tag"><span class="type">function</span></span>


												<p> This function is called when the command has passed all the checks and can execute. The first two
 arguments will be the running command table and the calling player. If the arguments field has been specified, the arguments
 will be passed as regular function parameters rather than in a table.</p>

<p> When the arguments field is defined: <code>OnRun(self, client, target, length, message)</code></p>

<p> When the arguments field is NOT defined: <code>OnRun(self, client, arguments)</code></p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">description</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>

													<span class="tag default">default: "@noDesc"</span>

												<p> The help text that appears when the user types in the command. If the string is
 prefixed with <code>&quot;@&quot;</code>, it will use a language phrase.</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">argumentNames</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.5">table</a></span>

													<span class="tag default">default: nil</span>

												<p>
<p> An array of strings corresponding to each argument of the command. This ignores the
 name that's specified in the <code>OnRun</code> function arguments and allows you to use any string to change the text that displays
 in the command's syntax help. When using this field, make sure that the amount is equal to the amount of arguments, as such:</p>
<pre><code>COMMAND.arguments = {ix.type.character, ix.type.number}
COMMAND.argumentNames = {"target char", "cash (1-1000)"}
</code></pre>
</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">arguments</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.5">table</a></span>

													<span class="tag default">optional</span>

												<p> If this field is defined, then additional checks will be performed to ensure that the
 arguments given to the command are valid. This removes extra boilerplate code since all the passed arguments are guaranteed
 to be valid. See <a href="../libraries/ix.command.html#CommandArgumentsStructure">CommandArgumentsStructure</a> for more information.</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">adminOnly</span>

													<span class="tag"><span class="type">boolean</span></span>

													<span class="tag default">default: false</span>

												<p> Provides an additional check to see if the user is an admin before running.</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">superAdminOnly</span>

													<span class="tag"><span class="type">boolean</span></span>

													<span class="tag default">default: false</span>

												<p> Provides an additional check to see if the user is a superadmin before running.</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">privilege</span>

													<span class="tag"><a class="type" href="https://www.lua.org/manual/5.2/manual.html#6.4">string</a></span>

													<span class="tag default">default: nil</span>

												<p> Manually specify a privilege name for this command. It will always be prefixed with
 <code>&quot;Helix - &quot;</code>. This is used in the case that you want to group commands under the same privilege, or use a privilege that
 you've already defined (i.e grouping <code>/CharBan</code> and <code>/CharUnban</code> into the <code>Helix - Ban Character</code> privilege).</p>
											</li>
									</ul>

									<ul>

											<li>
												<span class="tag parameter">OnCheckAccess</span>

													<span class="tag"><span class="type">function</span></span>

													<span class="tag default">default: nil</span>

												<p> This callback checks whether or not the player is allowed to run the command.
 This callback should <strong>NOT</strong> be used in conjunction with <code>adminOnly</code> or <code>superAdminOnly</code>, as populating those
 fields create a custom a <code>OnCheckAccess</code> callback for you internally. This is used in cases where you want more fine-grained
 access control for your command.</p>

<p> Keep in mind that this is a <strong>SHARED</strong> callback; the command will not show up the client if the callback returns <code>false</code>.</p>
											</li>
									</ul>


						</section>
		</article>

		<footer>
			<p>Generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></p>
		</footer>

		<script type="text/javascript" src="../highlight.min.js"></script>
		<script type="text/javascript">
		var elements = document.querySelectorAll("aside code, pre code")

		hljs.configure({
			languages: ["lua"]
		});

		for (var i = 0; i < elements.length; i++)
		{
			hljs.highlightBlock(elements[i]);
		}
		</script>
	</body>
</html>
